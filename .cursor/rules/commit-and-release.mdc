---
globs: package.json,commitlint.config.js,.husky/**,*.md
description: æäº¤è§„èŒƒã€å‘å¸ƒæµç¨‹ä¸ Git å·¥ä½œæµ
---
# æäº¤è§„èŒƒä¸å‘å¸ƒæµç¨‹

## æäº¤ä¿¡æ¯è§„èŒƒ

### Conventional Commits
é¡¹ç›®é‡‡ç”¨ **Conventional Commits** è§„èŒƒï¼Œé…ç½®æ–‡ä»¶ä½äº [commitlint.config.js](mdc:commitlint.config.js)ï¼š

```javascript
module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'references-empty': [2, 'never'], // æäº¤éœ€åŒ…å« issue å¼•ç”¨
    'body-max-line-length': [1, 'always', 500], // æ­£æ–‡æœ€å¤§é•¿åº¦
  },
}
```

### æäº¤æ ¼å¼
```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

### æäº¤ç±»å‹
- **feat**: æ–°åŠŸèƒ½
- **fix**: ä¿®å¤ bug
- **docs**: æ–‡æ¡£æ›´æ–°
- **style**: ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- **refactor**: ä»£ç é‡æ„
- **perf**: æ€§èƒ½ä¼˜åŒ–
- **test**: æµ‹è¯•ç›¸å…³
- **build**: æ„å»ºç³»ç»Ÿæˆ–å¤–éƒ¨ä¾èµ–å˜æ›´
- **ci**: CI é…ç½®æ–‡ä»¶å’Œè„šæœ¬å˜æ›´
- **chore**: å…¶ä»–ä¸ä¿®æ”¹ src æˆ– test æ–‡ä»¶çš„å˜æ›´

### æäº¤ç¤ºä¾‹
```bash
# æ–°åŠŸèƒ½
feat(auth): add OAuth2 login support

# ä¿®å¤ bug
fix(router): resolve navigation guard issue

# æ–‡æ¡£æ›´æ–°
docs: update API documentation

# é‡æ„
refactor(store): simplify user state management

# æ€§èƒ½ä¼˜åŒ–
perf(components): optimize image loading

# æµ‹è¯•
test(utils): add unit tests for date formatting

# æ„å»º
build: update Vite to v7.1.11

# CI
ci: add GitHub Actions workflow

# å…¶ä»–
chore: update dependencies
```

## é¢„æäº¤æ£€æŸ¥

### Husky é…ç½®
é¡¹ç›®ä½¿ç”¨ Husky ç®¡ç† Git hooksï¼Œé…ç½®ä½äº `.husky/` ç›®å½•ï¼š

```bash
# .husky/pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx lint-staged
```

### Lint-staged é…ç½®
åœ¨ [package.json](mdc:package.json) ä¸­é…ç½®ï¼š

```json
{
  "lint-staged": {
    "*.{ts,tsx,vue,js,json,md,yml}": "eslint --fix",
    "*.{test,spec}.{ts,tsx,vue,js}": "eslint --fix"
  }
}
```

### æäº¤ä¿¡æ¯æ£€æŸ¥
```bash
# .husky/commit-msg
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npx --no -- commitlint --edit ${1}
```

## ç‰ˆæœ¬ç®¡ç†

### Release Please é…ç½®
é¡¹ç›®ä½¿ç”¨ Google çš„ `release-please` è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œé‡‡ç”¨ **é¢„å‘å¸ƒ PR** å·¥ä½œæµï¼š

#### æ ¸å¿ƒé…ç½®æ–‡ä»¶
- **.github/release-please-config.json**: Release Please ä¸»é…ç½®
- **.github/.release-please-manifest.json**: å½“å‰ç‰ˆæœ¬è¿½è¸ª

#### é…ç½®ç¤ºä¾‹
```json
// release-please-config.json
{
  "release-type": "node",
  "packages": {
    ".": {
      "changelog-path": "CHANGELOG.md",
      "release-type": "node"
    }
  },
  "changelog-sections": [
    { "type": "feat", "section": "âœ¨ Features" },
    { "type": "fix", "section": "ğŸ› Bug Fixes" },
    { "type": "perf", "section": "âš¡ Performance Improvements" },
    { "type": "docs", "section": "ğŸ“ Documentation" },
    { "type": "refactor", "section": "â™»ï¸ Code Refactoring" }
  ]
}
```

### ç‰ˆæœ¬å‘å¸ƒæµç¨‹
1. **æäº¤ä»£ç **: ä½¿ç”¨ Conventional Commits æ ¼å¼æ¨é€åˆ° `main` åˆ†æ”¯
2. **è‡ªåŠ¨åˆ›å»º Release PR**: `release-please` åˆ†ææäº¤ä¿¡æ¯ï¼Œè‡ªåŠ¨åˆ›å»º/æ›´æ–° Release PR
3. **é¢„è§ˆå˜æ›´**: Release PR ä¸­åŒ…å«ç‰ˆæœ¬å·ã€CHANGELOG é¢„è§ˆ
4. **åˆå…¥å‘å¸ƒ**: å½“å‡†å¤‡å¥½å‘å¸ƒæ—¶ï¼Œåˆå…¥ Release PR
5. **è‡ªåŠ¨å‘å¸ƒ**: åˆå…¥åè‡ªåŠ¨åˆ›å»º Git Tag å’Œ GitHub Release

### å·¥ä½œæµç‰¹ç‚¹
- âœ… **å¯æ§å‘å¸ƒ**: ç‰ˆæœ¬å‘å¸ƒç”±å¼€å‘è€…å†³å®šï¼Œé€šè¿‡åˆå…¥ PR è§¦å‘
- âœ… **å˜æ›´é¢„è§ˆ**: Release PR ä¸­å¯é¢„è§ˆæ‰€æœ‰å³å°†å‘å¸ƒçš„å˜æ›´
- âœ… **è‡ªåŠ¨ CHANGELOG**: è‡ªåŠ¨æ ¹æ®æäº¤ä¿¡æ¯ç”Ÿæˆå˜æ›´æ—¥å¿—
- âœ… **è¯­ä¹‰åŒ–ç‰ˆæœ¬**: è‡ªåŠ¨æ ¹æ® `feat`/`fix` ç­‰ç±»å‹è®¡ç®—ç‰ˆæœ¬å·

## Git å·¥ä½œæµ

### åˆ†æ”¯ç­–ç•¥
- **main**: ä¸»åˆ†æ”¯ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒ
- **develop**: å¼€å‘åˆ†æ”¯ï¼Œç”¨äºé›†æˆåŠŸèƒ½
- **feature/***: åŠŸèƒ½åˆ†æ”¯ï¼Œå¦‚ `feature/user-auth`
- **bugfix/***: ä¿®å¤åˆ†æ”¯ï¼Œå¦‚ `bugfix/login-error`
- **hotfix/***: çƒ­ä¿®å¤åˆ†æ”¯ï¼Œå¦‚ `hotfix/security-patch`

### åˆ†æ”¯å‘½åè§„èŒƒ
```bash
# åŠŸèƒ½åˆ†æ”¯
feature/user-authentication
feature/dashboard-redesign

# ä¿®å¤åˆ†æ”¯
bugfix/login-validation
bugfix/memory-leak

# çƒ­ä¿®å¤åˆ†æ”¯
hotfix/security-vulnerability
hotfix/critical-bug

# å‘å¸ƒåˆ†æ”¯
release/v1.2.0
```

### æäº¤è§„èŒƒ
```bash
# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/user-profile

# æäº¤ä»£ç 
git add .
git commit -m "feat(user): add user profile component"

# æ¨é€åˆ†æ”¯
git push origin feature/user-profile

# åˆ›å»º Pull Request
# åˆå¹¶ååˆ é™¤åˆ†æ”¯
git branch -d feature/user-profile
```

## ä»£ç å®¡æŸ¥

### Pull Request æ¨¡æ¿
```markdown
## å˜æ›´æè¿°
<!-- æè¿°æœ¬æ¬¡å˜æ›´çš„å†…å®¹å’Œç›®çš„ -->

## å˜æ›´ç±»å‹
- [ ] Bug ä¿®å¤
- [ ] æ–°åŠŸèƒ½
- [ ] ç ´åæ€§å˜æ›´
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] ä»£ç é‡æ„
- [ ] æ€§èƒ½ä¼˜åŒ–

## æµ‹è¯•
- [ ] å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] E2E æµ‹è¯•
- [ ] æ‰‹åŠ¨æµ‹è¯•

## æ£€æŸ¥æ¸…å•
- [ ] ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
- [ ] ç±»å‹å®šä¹‰å®Œæ•´
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] æµ‹è¯•è¦†ç›–å……åˆ†
- [ ] æ–‡æ¡£æ›´æ–°å®Œæ•´
```

### å®¡æŸ¥è¦ç‚¹
- **ä»£ç è´¨é‡**: éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ
- **åŠŸèƒ½å®Œæ•´æ€§**: ç¡®ä¿åŠŸèƒ½æŒ‰é¢„æœŸå·¥ä½œ
- **æµ‹è¯•è¦†ç›–**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„æµ‹è¯•è¦†ç›–
- **æ–‡æ¡£æ›´æ–°**: ç¡®ä¿ç›¸å…³æ–‡æ¡£å·²æ›´æ–°
- **æ€§èƒ½å½±å“**: è¯„ä¼°æ€§èƒ½å½±å“
- **å®‰å…¨æ€§**: æ£€æŸ¥æ½œåœ¨çš„å®‰å…¨é—®é¢˜

## å‘å¸ƒæµç¨‹

### å¼€å‘æµç¨‹
1. **åˆ›å»ºåˆ†æ”¯**: ä» `main` åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
2. **å¼€å‘åŠŸèƒ½**: åœ¨åˆ†æ”¯ä¸Šå¼€å‘åŠŸèƒ½
3. **æäº¤ä»£ç **: ä½¿ç”¨è§„èŒƒçš„æäº¤ä¿¡æ¯
4. **åˆ›å»º PR**: åˆ›å»º Pull Request
5. **ä»£ç å®¡æŸ¥**: å›¢é˜Ÿæˆå‘˜å®¡æŸ¥ä»£ç 
6. **åˆå¹¶ä»£ç **: å®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ° `main`
7. **Release PR æ›´æ–°**: `release-please` è‡ªåŠ¨åˆ›å»º/æ›´æ–° Release PR
8. **ç‰ˆæœ¬å‘å¸ƒ**: å‡†å¤‡å¥½å‘å¸ƒæ—¶ï¼Œåˆå…¥ Release PR è§¦å‘æ­£å¼å‘å¸ƒ

### å‘å¸ƒæ£€æŸ¥æ¸…å•
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] æ–‡æ¡£æ›´æ–°å®Œæ•´
- [ ] ç‰ˆæœ¬å·æ­£ç¡®
- [ ] å˜æ›´æ—¥å¿—æ›´æ–°
- [ ] ä¾èµ–é¡¹æ£€æŸ¥

### å›æ»šç­–ç•¥
```bash
# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
git revert <commit-hash>

# å›æ»šåˆ°æŒ‡å®šæ ‡ç­¾
git checkout <tag-name>

# åˆ›å»ºå›æ»š PR
git checkout -b hotfix/rollback-v1.2.0
git revert <commit-hash>
git push origin hotfix/rollback-v1.2.0
```

## æœ€ä½³å®è·µ

### æäº¤è§„èŒƒ
- ä½¿ç”¨æ¸…æ™°çš„æäº¤ä¿¡æ¯
- ä¸€ä¸ªæäº¤åªåšä¸€ä»¶äº‹
- æäº¤å‰è¿è¡Œæµ‹è¯•
- ä½¿ç”¨æœ‰æ„ä¹‰çš„æäº¤ç±»å‹

### åˆ†æ”¯ç®¡ç†
- ä¿æŒåˆ†æ”¯ç®€æ´
- åŠæ—¶åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯
- ä½¿ç”¨æœ‰æ„ä¹‰çš„åˆ†æ”¯å
- é¿å…åœ¨ `main` åˆ†æ”¯ç›´æ¥æäº¤

### ä»£ç å®¡æŸ¥
- åŠæ—¶å®¡æŸ¥ä»£ç 
- æä¾›å»ºè®¾æ€§åé¦ˆ
- å…³æ³¨ä»£ç è´¨é‡
- ç¡®ä¿æµ‹è¯•è¦†ç›–

### å‘å¸ƒç®¡ç†
- ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬
- ä¿æŒå˜æ›´æ—¥å¿—æ›´æ–°
- æµ‹è¯•å‘å¸ƒæµç¨‹
- ç›‘æ§å‘å¸ƒç»“æœ